
<!DOCTYPE html>


<html lang="fr" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.3. Assemblage des Matrices &#8212; Maillage et Éléments Finis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=826a94cf" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=72dce1d2"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/translations.js?v=bf059b8c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"macros": {"dsp": "{\\displaystyle}", "gD": "{g_D}", "gN": "{g_N}", "GammaN": "{\\Gamma_N}", "GammaD": "{\\Gamma_D}", "GammaF": "\\Gamma_F", "Lo": "{L^2(\\Omega)}", "Ho": "{H^1(\\Omega)}", "Hoz": "{H^1_{0}(\\Omega)}", "HoD": "{H^1_{\\GammaD}(\\Omega)}", "Hog": "{H^1_{\\gD}(\\Omega)}", "Hoo": "{H^2(\\Omega)}", "Vh": "{V_h}", "Vhz": "{V_{h,0}}", "VhD": "{V_{h,\\GammaD}}", "abs": ["{\\left|#1\\right|}", 1], "norm": ["{\\left\\|#1\\right\\|}", 1], "PS": ["{\\left(#1,#2\\right)}", 2], "PSL": ["{\\PS{#1}{#2}_{\\Lo}}", 2], "PSLd": ["{\\PS{#1}{#2}_{\\Lo^d}}", 2], "PSH": ["{\\PS{#1}{#2}_{\\Ho}}", 2], "PSV": ["{\\PS{#1}{#2}_{V}}", 2], "normL": ["{\\norm{#1}_{\\Lo}}", 1], "normLd": ["{\\norm{#1}_{(\\Lo)^d}}", 1], "normH": ["{\\norm{#1}_{\\Ho}}", 1], "normV": ["{\\norm{#1}_{V}}", 1], "ut": "{u_t}", "uh": "{u_h}", "vh": "{v_h}", "Ahh": "{A}", "Bh": "{B}", "Uh": "{U}", "Rb": "{\\mathbb{R}}", "Nb": "{\\mathbb{N}}", "nn": "{\\mathbf{n}}", "dn": "{\\partial_{\\nn}}", "ee": "{\\mathbf{e}}", "xx": "{\\mathbf{x}}", "yy": "{\\mathbf{y}}", "zz": "{\\mathbf{z}}", "diff": "{\\mathrm{d}}", "Cscr": "{\\mathscr{C}}", "Ccal": "{\\mathcal{C}}", "mphi": "{\\varphi}", "mphih": "{\\widehat{\\varphi}}", "psih": "{\\widehat{\\psi}}", "gh": "{\\widehat{g}}", "deltaij": "{\\delta_{ij}}", "tri": "{K}", "trih": "{\\widehat{K}}", "vertice": "{\\mathbf{s}}", "verticeK": ["{\\vertice^{#1}}", 1], "verticeh": "{\\widehat{\\vertice}}", "grandO": ["{O\\left(#1\\right)}", 1], "Nh": "{N_h}", "Ns": "{N_s}", "Nt": "{N_t}", "Pb": "{\\mathbb{P}}", "Sh": "{\\mathscr{S}_h}", "Th": "{\\mathscr{T}_h}", "Ah": "{\\mathscr{A}_h}", "card": "{\\textrm{card}}", "supp": "{\\textrm{supp}}", "diam": "{\\textrm{diam}}", "Image": "{\\textrm{Im}}", "locToGlob": "{\\texttt{L2G}}", "trihToTri": ["{T_{#1}}", 1], "JK": ["{J_{#1}}", 1], "BK": ["{B_{#1}}", 1], "Meh": "{\\widehat{M}^e}", "Deh": "{\\widehat{D}^e}", "Me": ["{M^e_{#1}}", 1], "De": ["{D^e_{#1}}", 1], "enstq": ["{\\left\\{#1 \\mathrel{}\\middle|\\mathrel{}#2\\right\\}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture/elements-finis-triangulaires/assemblage';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="3.4. Calcul des Matrices Élémentaires" href="contributions-elementaires.html" />
    <link rel="prev" title="3.2. Espace \(\Pb^1\)-Lagrange" href="espace-p1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Passer au contenu principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Haut de page</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Maillage et Éléments Finis</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Recherche</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Table des matières :</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Notes de cours</a><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerical-simulation/index.html">1. Simulation Numérique</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerical-simulation/EDP.html">1.1. Quelques exemples d’EDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerical-simulation/industrie.html">1.2. Industrie</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../weak-solution/index.html">2. Formulations Faibles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/rappels.html">2.1. Espaces de Hilbert : rappels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/weak-formulation.html">2.2. Formulation Faible</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/lax-milgram.html">2.3. Théorème de Lax-Milgram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/sobolev-spaces.html">2.4. Espaces de Sobolev</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/exemple.html">2.5. Application au problème modèle</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">3. Éléments Finis Triangulaires</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="galerkin.html">3.1. Méthode de Galerkin</a></li>
<li class="toctree-l3"><a class="reference internal" href="espace-p1.html">3.2. Espace <span class="math notranslate nohighlight">\(\Pb^1\)</span>-Lagrange</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">3.3. Assemblage des Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributions-elementaires.html">3.4. Calcul des Matrices Élémentaires</a></li>
<li class="toctree-l3"><a class="reference internal" href="matrice-creuse.html">3.5. Matrice Creuse</a></li>
</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../boundary-conditions/index.html">4. Conditions aux bords</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../boundary-conditions/neumann-heterogene.html">4.1. Conditions de Neumann hétérogène</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boundary-conditions/dirichlet.html">4.2. Condition de Dirichlet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boundary-conditions/fourier.html">4.3. Condition de Fourier</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../advanced/index.html">5. Avancée</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../advanced/error.html">5.1. Erreur comise et convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced/p2.html">5.2. Éléments Finis <span class="math notranslate nohighlight">\(\Pb^2\)</span></a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../numeric/index.html">Implémentation</a><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../numeric/gmsh/index.html">1. Maillage avec GMSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/gmsh/mesh.html">1.1. Prise en main de GMSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/gmsh/api.html">1.2. API GMSH</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../numeric/python/index.html">2. Solveur FEM Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/sparse.html">2.1. Matrices Creuses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/mesh.html">2.2. Gestion du maillage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/mass-stiffness.html">2.3. Matrices de Masse et de Rigidité</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/quadrature.html">2.4. Quadratures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/dirichlet.html">2.5. Conditions de Dirichlet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/solve.html">2.6. Résolution et Analyse</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../projet/index.html">Projet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../projet/2017-2018/index.html">1. 2017 - 2018 : Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projet/2020-2021/index.html">2. 2020 - 2021</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../download/index.html">Download</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Bertbk/course-fem-sphinx">Dépôt GitHub</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Téléchargez cette page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lecture/elements-finis-triangulaires/assemblage.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Télécharger le fichier source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimer au format PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Mode plein écran"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assemblage des Matrices</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenu </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithme-brut-force">3.3.1. Algorithme « brut-force »</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithme-d-assemblage">3.3.2. Algorithme d’assemblage</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="assemblage-des-matrices">
<h1><span class="section-number">3.3. </span>Assemblage des Matrices<a class="headerlink" href="#assemblage-des-matrices" title="Lien vers cette rubrique">#</a></h1>
<p>Nous devons maintenant calculer effectivement les coefficients <span class="math notranslate nohighlight">\(A_{I,J}\)</span> de la matrice <span class="math notranslate nohighlight">\(A\)</span> et <span class="math notranslate nohighlight">\(\Bh_{I}\)</span> du vecteur <span class="math notranslate nohighlight">\(B\)</span>. Nous nous intéressons pour l’instant uniquement à la matrice <span class="math notranslate nohighlight">\(A\)</span>.</p>
<section id="algorithme-brut-force">
<h2><span class="section-number">3.3.1. </span>Algorithme « brut-force »<a class="headerlink" href="#algorithme-brut-force" title="Lien vers cette rubrique">#</a></h2>
<p>Prenons deux indices de sommets <span class="math notranslate nohighlight">\(I\)</span> et <span class="math notranslate nohighlight">\(J\)</span> et rappelons la valeur du coefficient <span class="math notranslate nohighlight">\(A_{I,J}\)</span> :</p>
<div class="math notranslate nohighlight">
\[A_{I,J} = a(\mphi_J, \mphi_I) = \int_{\Omega}\nabla \mphi_J \cdot\nabla \mphi_I+ c\int_{\Omega}\mphi_J\mphi_I\]</div>
<p>Chaque intégrale sur <span class="math notranslate nohighlight">\(\Omega\)</span> peut être décomposée comme une somme sur les triangles <span class="math notranslate nohighlight">\(\tri_p\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  A_{I,J} &amp;= \sum_{p=1}^{\Nt} \int_{\tri_p}\nabla \mphi_J \cdot\nabla \mphi_I+ c\sum_{p=0}^{\Nt-1} \int_{\tri_p}\mphi_J\mphi_I\\
  \Bh_{I} &amp;= \sum_{p=1}^{\Nt}\int_{\tri_p}f(x)\mphi_I(x)\diff x.
\end{aligned}\end{split}\]</div>
<p>Soit deux sommets <span class="math notranslate nohighlight">\(\vertice_I\)</span> et <span class="math notranslate nohighlight">\(\vertice_J\)</span> n’appartenant pas un même triangle, alors <span class="math notranslate nohighlight">\(\supp(\mphi_I)\cap\supp(\mphi_J) =\emptyset\)</span>. Autrement dit, <span class="math notranslate nohighlight">\(\mphi_I\mphi_J\)</span> est toujours nul et donc le coefficient <span class="math notranslate nohighlight">\(A_{I,J}\)</span> est nul ! Vue autrement, si deux sommets <span class="math notranslate nohighlight">\(\vertice_I\)</span> et <span class="math notranslate nohighlight">\(\vertice_J\)</span> ne sont pas connectés par une arête, alors <span class="math notranslate nohighlight">\(A_{I,J=0}\)</span>.</p>
<p>Les coefficients de <span class="math notranslate nohighlight">\(A\)</span> sont donc majoritairement nuls car deux sommets pris au hasard (dans le million d’un maillage) ne sont pas connectés. En moyenne de manière empirique, un nœud (ou sommet) est connecté au maximum à 6 à 8 autres nœuds (en 2D). Une conséquence directe est que <strong>la matrice</strong> <span class="math notranslate nohighlight">\(A\)</span> <strong>est creuse</strong>, c’est-à-dire qu’un nombre important de ses coefficients sont nuls. Une stratégie de stockage creux est donc à utiliser, ce que nous verrons plus loin. Une manière pratique est d’utiliser le format <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_matrix#Coordinate_list_(COO)">COO</a> pour l’assemblage puis le format <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_matrix#Compressed_sparse_row_(CSR,_CRS_or_Yale_format))">CSR</a> pour l’algèbre linéaire et la résolution du système.</p>
<p>Nous devons bien entendu construire cette matrice : calculer chacun de ses coefficients et les stocker. Un algorithme naïf ou brut-force (mais naturel) pour calculer chaque coefficient est de boucler sur les sommets et et de remplir la matrice au fur et à mesure, c’est-à-dire de remplir les coefficients les uns après les autres. Il est présenté dans <a class="reference internal" href="#algo-brut-force"><span class="std std-ref">l’algorithme brut-force</span></a>.</p>
<p>Il est à noter que la boucle sur les triangles pourraient être simplifiée en ne bouclant que sur les triangles ayant pour sommet <span class="math notranslate nohighlight">\(\vertice_I\)</span> et <span class="math notranslate nohighlight">\(\vertice_J\)</span>. Cependant, cet algorithme a tout de même un coût en <span class="math notranslate nohighlight">\(\grandO{\Ns^2}\)</span> ce qui est trop important pour être utilisable en pratique.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<span id="algo-brut-force"></span><div class="code-block-caption"><span class="caption-number">Code source 3.1 </span><span class="caption-text">Algorithme brut-force</span><a class="headerlink" href="#id1" title="Lien vers ce code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>For<span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:N_s
<span class="w">  </span>For<span class="w"> </span><span class="nv">J</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:N_s
<span class="w">    </span>A<span class="o">(</span>I,J<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span>For<span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:N_t
<span class="w">      </span>A<span class="o">(</span>I,J<span class="o">)</span><span class="w"> </span>+<span class="o">=</span><span class="w"> </span>∫_<span class="o">{</span>K_p<span class="o">}</span><span class="w"> </span><span class="o">(</span>∇<span class="w"> </span>ϕ_J·∇<span class="w"> </span>ϕ_I<span class="o">)</span><span class="w"> </span>+∫_<span class="o">{</span>K_p<span class="o">}(</span>ϕ_J<span class="w"> </span>ϕ_I<span class="o">)</span>
<span class="w">    </span>EndFor
<span class="w">  </span>EndFor
<span class="w">  </span>B<span class="o">(</span>I<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span>For<span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:N_t
<span class="w">    </span>B<span class="o">[</span>I<span class="o">]</span><span class="w"> </span>+<span class="o">=</span><span class="w"> </span>∫_<span class="o">{</span>K_p<span class="o">}</span><span class="w"> </span><span class="o">(</span>f<span class="w"> </span>ϕ_I<span class="o">)</span>
<span class="w">  </span>EndFor
EndFor
</pre></div>
</div>
</div>
</section>
<section id="algorithme-d-assemblage">
<h2><span class="section-number">3.3.2. </span>Algorithme d’assemblage<a class="headerlink" href="#algorithme-d-assemblage" title="Lien vers cette rubrique">#</a></h2>
<p>Une autre manière de procéder, que l’on appelle <strong>assemblage</strong>, se base sur une boucle sur les triangles plutôt que sur les sommets. Le principe est de parcourir les triangles et de calculer des <strong>contributions élémentaires</strong>, qui vont s’ajouter petit à petit dans la matrice <span class="math notranslate nohighlight">\(A\)</span>. Reprenons l’expression du coefficient <span class="math notranslate nohighlight">\(A_{I,J}\)</span>:</p>
<div class="math notranslate nohighlight">
\[A_{I,J} = \sum_{p=1}^{\Nt} \underbrace{\int_{\tri_p}\nabla \mphi_J \cdot\nabla \mphi_I}_{\text{Contrib. élémentaire}}+ c\sum_{p=0}^{\Nt-1} \underbrace{\int_{\tri_p}\mphi_J\mphi_I}_{\text{Contrib. élémentaire}}\]</div>
<p>Introduisons <span class="math notranslate nohighlight">\(a_p(\cdot,\cdot)\)</span> la famille de forme bilinéaire suivante, pour <span class="math notranslate nohighlight">\(p=1,\ldots,\Nt\)</span> :</p>
<div class="math notranslate nohighlight">
\[a_p(\mphi_J,\mphi_I) = \int_{\tri_p}\nabla \mphi_J(\xx) \cdot\nabla \mphi_I(\xx)\diff \xx +c\int_{\tri_p}\mphi_J(\xx)\mphi_I(\xx)\diff \xx\]</div>
<p>Ensuite, nous réécrivons la matrice <span class="math notranslate nohighlight">\(A\)</span> sous la forme suivante</p>
<div class="math notranslate nohighlight">
\[A = \sum_{I=1}^{\Ns}\sum_{j=0}^{\Ns-1}a(\mphi_J,\mphi_I) \ee_I^T\ee_J,\]</div>
<p>où <span class="math notranslate nohighlight">\(\ee_I\)</span> est le vecteur de la base canonique de <span class="math notranslate nohighlight">\(\Rb^{\Ns}\)</span>.  Nous avons alors</p>
<div class="math notranslate nohighlight" id="equation-eq-assemble-tmp">
<span class="eqno">(3.3)<a class="headerlink" href="#equation-eq-assemble-tmp" title="Lien vers cette équation">#</a></span>\[\begin{split}\begin{aligned}
  A &amp;= \sum_{I=1}^{\Ns}\sum_{J=1}^{\Ns}a(\mphi_J,\mphi_I) \ee_I^T\ee_J\\
   &amp;=  \sum_{I=1}^{\Ns}\sum_{J=1}^{\Ns}\sum_{p=1}^{\Nt}a_{p}(\mphi_J,\mphi_I) \ee_I^T\ee_J\\
   &amp;=  \sum_{p=1}^{\Nt}\sum_{I=1}^{\Ns}\sum_{J=1}^{\Ns}a_{p}(\mphi_J,\mphi_I) \ee_I^T\ee_J\\
\end{aligned}\end{split}\]</div>
<p>Nous remarquons maintenant que <span class="math notranslate nohighlight">\(a_{p}(\mphi_J,\mphi_I)\)</span> est nul dès lors que <span class="math notranslate nohighlight">\(\vertice_I\)</span> ou <span class="math notranslate nohighlight">\(\vertice_J\)</span> ne sont pas des sommets de <span class="math notranslate nohighlight">\(\tri_p\)</span> (car <span class="math notranslate nohighlight">\(\mphi_I\mphi_J = 0\)</span> sur <span class="math notranslate nohighlight">\(\tri_p\)</span>). Finalement, la somme sur tous les sommets du maillage se réduit à une somme sur les 3 sommets du triangle <span class="math notranslate nohighlight">\(\tri_p\)</span> considéré.</p>
<p>Nous comprenons que nous devons maintenant travailler <strong>localement</strong> dans chaque triangle. Pour cela, nous avons besoin d’introduire une <strong>numérotation locale</strong> de chaque sommet une fonction <span class="math notranslate nohighlight">\(\locToGlob\)</span> (<em>Local To Global</em>)permettant de basculer du local vers le global une fonction telle que, pour <span class="math notranslate nohighlight">\(p=1,\ldots,\Nt\)</span> et <span class="math notranslate nohighlight">\(i=1,2,3\)</span> :</p>
<div class="math notranslate nohighlight">
\[\locToGlob(p,i) = I \iff \vertice_i^p = \vertice_I\]</div>
<p>Ainsi, pour un triangle  <span class="math notranslate nohighlight">\(\tri_p\)</span>, ses sommets sont numérotés <span class="math notranslate nohighlight">\([\vertice_{1}^{p},\vertice_{2}^{p},\vertice_{3}^{p}]\)</span> en numérotation locale ou <span class="math notranslate nohighlight">\([\vertice_{\locToGlob(p,1)},\vertice_{\locToGlob(p,2)},\vertice_{\locToGlob(p,3)}]\)</span> en numérotation globale, comme le montre la figure <a class="reference internal" href="#fig-loc2glob"><span class="std std-numref">3.4</span></a>. Nous distinguerons la numérotation globale par des lettres capitales (<span class="math notranslate nohighlight">\(I\)</span>, <span class="math notranslate nohighlight">\(J\)</span>) et la numérotation locale par des minuscules (<span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>). Nous introduisons aussi les fonctions de forme locales :</p>
<div class="math notranslate nohighlight">
\[\mphi_i^p = \mphi_{\locToGlob(p,i)}|_{\tri_p}.\]</div>
<div class="proof remark admonition" id="remark-0">
<p class="admonition-title"><span class="caption-number">Remark 3.5 </span></p>
<section class="remark-content" id="proof-content">
<p>Pour mieux comprendre la différence entre numérotation locale et globale, une <a class="reference external" href="#app-local-to-global">application est disponible en ligne</a>.</p>
</section>
</div><figure class="align-center" id="id2" style="width: 100%">
<span id="fig-loc2glob"></span><a class="reference internal image-reference" href="../../_images/loc2glob.svg"><img alt="Numérotation locale et globale" src="../../_images/loc2glob.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Numérotation locale et globale</span><a class="headerlink" href="#id2" title="Lien vers cette image">#</a></p>
</figcaption>
</figure>
<div id="app-local-to-global" class="app-container">
  <iframe id="iframe-local-to-global" class="app-content" src='../../../_static/app/loc2glob/index.html'></iframe>
  <p><strong>Cliquez sur un triangle</strong> pour faire apparaitre la <strong>numérotation locale</strong> des sommets du triangle. Recliquez dessus pour revenir en <strong>numérotation globale</strong></p>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.1/iframeResizer.min.js" integrity="sha512-ngVIPTfUxNHrVs52hA0CaOVwC3/do2W4jUEJIufgZQicmY27iAJAind8BPtK2LoyIGiAFcOkjO18r5dTUNLFAw==" crossorigin="anonymous"></script>
<script>
  iFrameResize({}, '#iframe-local-to-global')
</script><p>Utilisons ces nouvelles notations dans l’équation <a class="reference internal" href="#equation-eq-assemble-tmp">(3.3)</a>, en ramenant la somme sur les sommets à uniquement les sommets du triangle considéré :</p>
<div class="math notranslate nohighlight">
\[A = \sum_{p=1}^{\Nt}\sum_{i=1}^{3}\sum_{j=1}^{3}a_{p}(\mphi_j^p,\mphi_i^p) \ee_{\locToGlob(p,i)}^T\ee_{\locToGlob(p,j)}\]</div>
<p>L’algorithme d’assemblage est alors complet ! Une version pseudo-code est présenté par <a class="reference internal" href="#algo-assemblage"><span class="std std-ref">l’algorithme d’assemblage</span></a>. Sa complexité est en <span class="math notranslate nohighlight">\(\grandO{\Nt} \ll \grandO{\Ns^2}\)</span>. Comme <a class="reference internal" href="#algo-brut-force"><span class="std std-ref">le premier algorithme</span></a>, il possède en plus l’avantage d’être parallélisable.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<span id="algo-assemblage"></span><div class="code-block-caption"><span class="caption-number">Code source 3.2 </span><span class="caption-text">Algorithme d’assemblage</span><a class="headerlink" href="#id3" title="Lien vers ce code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="nv">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
For<span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:N_t
<span class="w">  </span>For<span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:3
<span class="w">    </span><span class="nv">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>L2G<span class="o">(</span>p,i<span class="o">)</span>
<span class="w">    </span>For<span class="w"> </span><span class="nv">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>:3
<span class="w">      </span><span class="nv">J</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>L2G<span class="o">(</span>p,j<span class="o">)</span>
<span class="w">      </span>A<span class="o">(</span>I,J<span class="o">)</span><span class="w"> </span>+<span class="o">=</span><span class="w"> </span>a_p<span class="o">(</span>ϕ_j^p,ϕ_i^p<span class="o">)</span>
<span class="w">    </span>EndFor
<span class="w">    </span>B<span class="o">(</span>I<span class="o">)</span><span class="w"> </span>+<span class="o">=</span><span class="w"> </span>l_p<span class="o">(</span>ϕ_i^p<span class="o">)</span>
<span class="w">  </span>EndFor
EndFor
</pre></div>
</div>
</div>
<div class="proof remark admonition" id="remark-1">
<p class="admonition-title"><span class="caption-number">Remark 3.6 </span></p>
<section class="remark-content" id="proof-content">
<p>Cet algorithme n’est pas encore utilisable, nous devons calculer la valeur de <span class="math notranslate nohighlight">\(a_p(\mphi_j^p,\mphi_i^p)\)</span> et <span class="math notranslate nohighlight">\(\ell_p(\mphi_i^p)\)</span>. De plus, il manque encore les conditions de Dirichlet.</p>
</section>
</div><script defer="defer" src="https://d3js.org/d3.v5.min.js"></script>
<script defer="defer" src="https://d3js.org/d3-scale-chromatic.v1.min.js</script>
<script defer="defer" src="../../../_static/js/loc2glob/main.js"></script></section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="espace-p1.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Espace <span class="math notranslate nohighlight">\(\Pb^1\)</span>-Lagrange</p>
      </div>
    </a>
    <a class="right-next"
       href="contributions-elementaires.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title"><span class="section-number">3.4. </span>Calcul des Matrices Élémentaires</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenu
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithme-brut-force">3.3.1. Algorithme « brut-force »</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithme-d-assemblage">3.3.2. Algorithme d’assemblage</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Par Bertrand Thierry
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, Bertrand Thierry.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>