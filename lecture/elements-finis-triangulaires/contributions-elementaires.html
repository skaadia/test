

<!DOCTYPE html>


<html lang="fr" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.4. Calcul des Matrices Élémentaires &#8212; Recueil d&#39;Exercices Classiques de Mathématiques</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"macros": {"dsp": "{\\displaystyle}", "gD": "{g_D}", "gN": "{g_N}", "GammaN": "{\\Gamma_N}", "GammaD": "{\\Gamma_D}", "GammaF": "\\Gamma_F", "Lo": "{L^2(\\Omega)}", "Ho": "{H^1(\\Omega)}", "Hoz": "{H^1_{0}(\\Omega)}", "HoD": "{H^1_{\\GammaD}(\\Omega)}", "Hog": "{H^1_{\\gD}(\\Omega)}", "Hoo": "{H^2(\\Omega)}", "Vh": "{V_h}", "Vhz": "{V_{h,0}}", "VhD": "{V_{h,\\GammaD}}", "abs": ["{\\left|#1\\right|}", 1], "norm": ["{\\left\\|#1\\right\\|}", 1], "PS": ["{\\left(#1,#2\\right)}", 2], "PSL": ["{\\PS{#1}{#2}_{\\Lo}}", 2], "PSLd": ["{\\PS{#1}{#2}_{\\Lo^d}}", 2], "PSH": ["{\\PS{#1}{#2}_{\\Ho}}", 2], "PSV": ["{\\PS{#1}{#2}_{V}}", 2], "normL": ["{\\norm{#1}_{\\Lo}}", 1], "normLd": ["{\\norm{#1}_{(\\Lo)^d}}", 1], "normH": ["{\\norm{#1}_{\\Ho}}", 1], "normV": ["{\\norm{#1}_{V}}", 1], "ut": "{u_t}", "uh": "{u_h}", "vh": "{v_h}", "Ahh": "{A}", "Bh": "{B}", "Uh": "{U}", "Rb": "{\\mathbb{R}}", "Nb": "{\\mathbb{N}}", "nn": "{\\mathbf{n}}", "dn": "{\\partial_{\\nn}}", "ee": "{\\mathbf{e}}", "xx": "{\\mathbf{x}}", "yy": "{\\mathbf{y}}", "zz": "{\\mathbf{z}}", "diff": "{\\mathrm{d}}", "Cscr": "{\\mathscr{C}}", "Ccal": "{\\mathcal{C}}", "mphi": "{\\varphi}", "mphih": "{\\widehat{\\varphi}}", "psih": "{\\widehat{\\psi}}", "gh": "{\\widehat{g}}", "deltaij": "{\\delta_{ij}}", "tri": "{K}", "trih": "{\\widehat{K}}", "vertice": "{\\mathbf{s}}", "verticeK": ["{\\vertice^{#1}}", 1], "verticeh": "{\\widehat{\\vertice}}", "grandO": ["{O\\left(#1\\right)}", 1], "Nh": "{N_h}", "Ns": "{N_s}", "Nt": "{N_t}", "Pb": "{\\mathbb{P}}", "Sh": "{\\mathscr{S}_h}", "Th": "{\\mathscr{T}_h}", "Ah": "{\\mathscr{A}_h}", "card": "{\\textrm{card}}", "supp": "{\\textrm{supp}}", "diam": "{\\textrm{diam}}", "Image": "{\\textrm{Im}}", "locToGlob": "{\\texttt{L2G}}", "trihToTri": ["{T_{#1}}", 1], "JK": ["{J_{#1}}", 1], "BK": ["{B_{#1}}", 1], "Meh": "{\\widehat{M}^e}", "Deh": "{\\widehat{D}^e}", "Me": ["{M^e_{#1}}", 1], "De": ["{D^e_{#1}}", 1], "enstq": ["{\\left\\{#1 \\mathrel{}\\middle|\\mathrel{}#2\\right\\}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture/elements-finis-triangulaires/contributions-elementaires';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="4.5. Matrice Creuse" href="matrice-creuse.html" />
    <link rel="prev" title="4.3. Assemblage des Matrices" href="assemblage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Passer au contenu principal</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">Recueil d'Exercices Classiques de Mathématiques</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Table des matières :</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Chapitres</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../integration/index.html">1. Intégration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerical-simulation/index.html">2. Simulation Numérique</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerical-simulation/EDP.html">2.1. Quelques exemples d’EDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerical-simulation/industrie.html">2.2. Industrie</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../weak-solution/index.html">3. Formulations Faibles</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/rappels.html">3.1. Espaces de Hilbert : rappels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/weak-formulation.html">3.2. Formulation Faible</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/lax-milgram.html">3.3. Théorème de Lax-Milgram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/sobolev-spaces.html">3.4. Espaces de Sobolev</a></li>
<li class="toctree-l3"><a class="reference internal" href="../weak-solution/exemple.html">3.5. Application au problème modèle</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">4. Éléments Finis Triangulaires</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="galerkin.html">4.1. Méthode de Galerkin</a></li>
<li class="toctree-l3"><a class="reference internal" href="espace-p1.html">4.2. Espace <span class="math notranslate nohighlight">\(\Pb^1\)</span>-Lagrange</a></li>
<li class="toctree-l3"><a class="reference internal" href="assemblage.html">4.3. Assemblage des Matrices</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">4.4. Calcul des Matrices Élémentaires</a></li>
<li class="toctree-l3"><a class="reference internal" href="matrice-creuse.html">4.5. Matrice Creuse</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../boundary-conditions/index.html">5. Conditions aux bords</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../boundary-conditions/neumann-heterogene.html">5.1. Conditions de Neumann hétérogène</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boundary-conditions/dirichlet.html">5.2. Condition de Dirichlet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boundary-conditions/fourier.html">5.3. Condition de Fourier</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../advanced/index.html">6. Avancée</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../advanced/error.html">6.1. Erreur comise et convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced/p2.html">6.2. Éléments Finis <span class="math notranslate nohighlight">\(\Pb^2\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../numeric/index.html">Implémentation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../numeric/gmsh/index.html">1. Maillage avec GMSH</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/gmsh/mesh.html">1.1. Prise en main de GMSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/gmsh/api.html">1.2. API GMSH</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../numeric/python/index.html">2. Solveur FEM Python</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/sparse.html">2.1. Matrices Creuses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/mesh.html">2.2. Gestion du maillage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/mass-stiffness.html">2.3. Matrices de Masse et de Rigidité</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/quadrature.html">2.4. Quadratures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/dirichlet.html">2.5. Conditions de Dirichlet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../numeric/python/solve.html">2.6. Résolution et Analyse</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../projet/index.html">Projet</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../projet/2017-2018/index.html">1. 2017 - 2018 : Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projet/2020-2021/index.html">2. 2020 - 2021</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../download/index.html">Version PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apropos/index.html">À propos de ce site</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/armandwayoff/RECM">Dépôt GitHub</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Téléchargez cette page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lecture/elements-finis-triangulaires/contributions-elementaires.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Télécharger le fichier source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimer au format PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Mode plein écran"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Calcul des Matrices Élémentaires</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenu </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-de-masse-et-de-rigidite">4.4.1. Matrices de Masse et de Rigidité</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contribution-elementaire">4.4.2. Contribution élémentaire</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrice-de-masse-elementaire">4.4.3. Matrice de masse élémentaire</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triangle-de-reference">4.4.3.1. Triangle de référence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triangle-quelconque">4.4.3.2. Triangle quelconque</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrice-de-rigidite-elementaire">4.4.4. Matrice de rigidité élémentaire</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.4.4.1. Triangle de référence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4.4.4.2. Triangle quelconque</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-membre-ou-rhs-ou-membre-de-droite">4.4.5. Second membre (ou RHS ou Membre de droite)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="calcul-des-matrices-elementaires">
<h1><span class="section-number">4.4. </span>Calcul des Matrices Élémentaires<a class="headerlink" href="#calcul-des-matrices-elementaires" title="Lien permanent vers ce titre">#</a></h1>
<section id="matrices-de-masse-et-de-rigidite">
<h2><span class="section-number">4.4.1. </span>Matrices de Masse et de Rigidité<a class="headerlink" href="#matrices-de-masse-et-de-rigidite" title="Lien permanent vers ce titre">#</a></h2>
<p>La matrice <span class="math notranslate nohighlight">\(A\)</span> peut être décomposée en deux matrices : la masse et la rigidité :</p>
<div class="math notranslate nohighlight">
\[A = D + c M,\]</div>
<ul>
<li><p><span class="math notranslate nohighlight">\(M\)</span> : la matrice de masse (ou de volume), de coefficient</p>
<div class="math notranslate nohighlight">
\[M_{I,J} = \int_{\Omega} \mphi_J\mphi_I.\]</div>
</li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> : la matrice de rigidité, de coefficient</p>
<div class="math notranslate nohighlight">
\[D_{I,J}=  \int_{\Omega}\nabla\mphi_J\nabla\mphi_I.\]</div>
</li>
</ul>
<p>La matrice de masse <span class="math notranslate nohighlight">\(M\)</span> représente l’opérateur Identité dans la base des fonctions de forme (qui n’est ni orthogonale ni normée !). Pour s’en convaincre, il faut regarder « l’équation » <span class="math notranslate nohighlight">\(u=f\)</span> et appliquer la méthode des éléments finis pour obtenir la « formulation faible » suivante</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
\text{Trouver }\uh\in\Vh, \text{ tel que }\\
\forall \vh, \quad \int_{\Omega} \uh\vh = \int_{\Omega}f\vh,
\end{cases}
\iff MU = B\end{split}\]</div>
<p>L’opérateur Identité, appliqué à <span class="math notranslate nohighlight">\(\uh\)</span>, est bien discrétisé en <span class="math notranslate nohighlight">\(M\)</span>. À noter que la masse n’apparait pas directement dans le second membre car on la calcul par des règles de quadratures, cependant si <span class="math notranslate nohighlight">\(f \in \Vh\)</span> alors le système linéaire serait tout simplement <span class="math notranslate nohighlight">\(MU = MF \iff U=F\)</span>.</p>
<p>La matrice de rigidité porte ce nom en raison de l’analogie avec des problèmes de mécanique du solide (ressort).</p>
<p>Les deux propriétés suivantes des matrices de masse et de rigidité ont une utilité pratique pour l’implémentation à des fins de validations.</p>
<div class="proof lemma admonition" id="lemma-0">
<p class="admonition-title"><span class="caption-number">Lemma 4.6 </span></p>
<section class="lemma-content" id="proof-content">
<p>Soit <span class="math notranslate nohighlight">\(X=[1,1,\ldots,1]^T\)</span> le vecteur rempli de 1, alors</p>
<div class="math notranslate nohighlight">
\[X^TMX = |\Omega| \qquad\text{ et } \qquad DX = 0.\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. Nous utilisons le <code class="xref std std-numref docutils literal notranslate"><span class="pre">lemme</span> <span class="pre">{number}</span></code>  pour obtenir la première relation</p>
<div class="math notranslate nohighlight">
\[X^TMX = \sum_{I=1}^{\Ns}\sum_{J=1}^{\Ns} M_{I,J}= \sum_{I=1}^{\Ns}\sum_{J=1}^{\Ns} \int_{\Omega}\mphi_J\mphi_I =  \int_{\Omega}\sum_{I=1}^{\Ns}\mphi_I \sum_{J=1}^{\Ns}\mphi_J = \int_{\Omega} 1 = |\Omega|,\]</div>
<p>et aussi la seconde, pour <span class="math notranslate nohighlight">\(I=1,\ldots,\Ns\)</span>,</p>
<div class="math notranslate nohighlight">
\[(DX)_I = \sum_{J=1}^{\Ns} D_{I,J}= \sum_{J=1}^{\Ns} \int_{\Omega}\nabla\mphi_J\cdot\nabla\mphi_I = \int_{\Omega} \nabla\left(\sum_{J=1}^{\Ns}\mphi_J\right)\cdot\nabla\mphi_I = \int_{\Omega} \nabla(1)\cdot\nabla\mphi_I = 0.\]</div>
</div>
<div class="proof remark admonition" id="remark-1">
<p class="admonition-title"><span class="caption-number">Remark 4.7 </span></p>
<section class="remark-content" id="proof-content">
<p>Dans la littérature, cette matrice est souvent notée <span class="math notranslate nohighlight">\(K\)</span>, mais nous l’appelons <span class="math notranslate nohighlight">\(D\)</span> pour éviter toute confusion avec les triangles, nommés <span class="math notranslate nohighlight">\(K\)</span> également.</p>
</section>
</div><div class="proof remark admonition" id="remark-2">
<p class="admonition-title"><span class="caption-number">Remark 4.8 </span></p>
<section class="remark-content" id="proof-content">
<p>La matrice de masse devrait plutôt s’appeler <em>matrice de volume</em> car elle mesure le volume et non la masse…</p>
</section>
</div></section>
<section id="contribution-elementaire">
<h2><span class="section-number">4.4.2. </span>Contribution élémentaire<a class="headerlink" href="#contribution-elementaire" title="Lien permanent vers ce titre">#</a></h2>
<p>Les <strong>contributions élémentaires</strong>, c’est à dire les quantités <span class="math notranslate nohighlight">\(a_p(\mphi_j^p,\mphi_i^p)\)</span> et <span class="math notranslate nohighlight">\(\ell_{p}(\mphi_i^p)\)</span>, peuvent elles aussi être décomposées en deux parties. Pour rappel, les sommets d’un triangle <span class="math notranslate nohighlight">\(\tri_p\)</span> seront notés <span class="math notranslate nohighlight">\([\vertice_{0}^{p}, \vertice_{1}^{p},\vertice_{2}^{p}]\)</span> et ordonnés dans le sens trigonométrique. Nous noterons <span class="math notranslate nohighlight">\(\vertice_i^p=(x_i^p, y_i^p)\)</span> un sommet de <span class="math notranslate nohighlight">\(\tri_p\)</span> et <span class="math notranslate nohighlight">\(\mphi_i^p\)</span> la fonction de forme locale associée. Nous notons <span class="math notranslate nohighlight">\(\Me{p}\)</span> et <span class="math notranslate nohighlight">\(\De{p}\)</span> les matrices de masse et de rigidité élémentaire du triangle <span class="math notranslate nohighlight">\(\tri_p\)</span>, de coefficient respectif <span class="math notranslate nohighlight">\((\Me{p})_{i,j}\)</span> et <span class="math notranslate nohighlight">\((\De{p})_{i,j}\)</span> donnés par</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  (\Me{p})_{i,j} &amp;= \int_{\tri_p}\mphi_j^p\mphi_i^p\\
  (\De{p})_{i,j} &amp;=\int_{\tri_p}\nabla\mphi_j^p\cdot\nabla\mphi_i^p.
\end{aligned}\end{split}\]</div>
</section>
<section id="matrice-de-masse-elementaire">
<h2><span class="section-number">4.4.3. </span>Matrice de masse élémentaire<a class="headerlink" href="#matrice-de-masse-elementaire" title="Lien permanent vers ce titre">#</a></h2>
<p>Nous nous focalisons sur la matrice de masse, le principe est similaire pour la matrice <span class="math notranslate nohighlight">\(D\)</span> et est détaillé juste après.</p>
<p>Pour construire la matrice <span class="math notranslate nohighlight">\(M\)</span>, nous avons vu qu’il était préférable de parcourir les triangles plutôt que les sommets, autrement dit, plutôt que de calculer <span class="math notranslate nohighlight">\(M_{I,J}\)</span> directement, mieux vaut calculer, pour tout triangle <span class="math notranslate nohighlight">\(p\)</span>, la <strong>contribution élémentaire</strong> <span class="math notranslate nohighlight">\((\Me{p})_{i,j}\)</span> pour <span class="math notranslate nohighlight">\(i,j = 1,2,3\)</span>, définie par :</p>
<div class="math notranslate nohighlight" id="equation-eq-matelem">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-eq-matelem" title="Lien permanent vers cette équation">#</a></span>\[(\Me{p})_{i,j}= \int_{\tri_p} \mphi_j^p(\xx)\ \mphi_i^p(\xx)\diff\xx.\]</div>
<p>Chaque contribution élémentaire <span class="math notranslate nohighlight">\((\Me{p})_{i,j}\)</span> est ensuite ajoutée à <span class="math notranslate nohighlight">\(M_{I,J}\)</span>, avec <span class="math notranslate nohighlight">\(I=\locToGlob(p,i)\)</span> et <span class="math notranslate nohighlight">\(J=\locToGlob(p,j)\)</span>.</p>
<section id="triangle-de-reference">
<h3><span class="section-number">4.4.3.1. </span>Triangle de référence<a class="headerlink" href="#triangle-de-reference" title="Lien permanent vers ce titre">#</a></h3>
<p>Pour calculer la quantité élémentaire <a class="reference internal" href="#equation-eq-matelem">(4.4)</a>, plaçons nous tout d’abord dans un triangle « simple » <span class="math notranslate nohighlight">\(\trih\)</span>, appelé <strong>triangle de référence</strong>. Celui-ci est souvent choisi comme étant le triangle rectangle de sommets <span class="math notranslate nohighlight">\(\verticeh_{1}=(0,0)\)</span>, <span class="math notranslate nohighlight">\(\verticeh_{2}=(1,0)\)</span> et <span class="math notranslate nohighlight">\(\verticeh_{3}=(0,1)\)</span>, ordonnés dans le sens trigonométrique. Pour différencier ce triangle d’un triangle du maillage, nous lui adjoignons un repère <span class="math notranslate nohighlight">\((\xi,\eta)\)</span>   dit <strong>repère paramétrique</strong>.</p>
<figure class="align-center" id="id3" style="width: 100%">
<span id="fig-triangle-reference"></span><a class="reference internal image-reference" href="../../_images/reference-triangle.svg"><img alt="Triangle de référence" src="../../_images/reference-triangle.svg" width="50%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Triangle de référence <span class="math notranslate nohighlight">\(\trih\)</span> et son repère paramétrique <span class="math notranslate nohighlight">\((\xi,\eta)\)</span>.</span><a class="headerlink" href="#id3" title="Lien permanent vers cette image">#</a></p>
</figcaption>
</figure>
<p>Nous notons <span class="math notranslate nohighlight">\(\mphih_i \in \Pb^1(\trih)\)</span> les trois fonctions de forme associées aux sommets <span class="math notranslate nohighlight">\(\verticeh_i\)</span>, pour <span class="math notranslate nohighlight">\(i=1,1,3\)</span>, définies par <span class="math notranslate nohighlight">\(\mphih_i(\verticeh_j) = \delta_{ij}\)</span>. Ces fonctions <span class="math notranslate nohighlight">\(\mphih_i\)</span> étant des polynômes de degré un, nous pouvons les calculer analytiquement :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
  \begin{array}{l}
    \mphih_1(\xi,\eta) = 1-\xi-\eta\\
    \mphih_2(\xi,\eta) = \xi\\
    \mphih_3(\xi,\eta) = \eta\\
  \end{array}
\right.\end{split}\]</div>
<div class="proof lemma admonition" id="lemma-3">
<p class="admonition-title"><span class="caption-number">Lemma 4.7 </span></p>
<section class="lemma-content" id="proof-content">
<p>Dans le triangle <span class="math notranslate nohighlight">\(\trih\)</span>, la matrice de masse élémentaire <span class="math notranslate nohighlight">\(\Meh = (\Meh_{i,j})_{1\leq i,j\leq 3}\)</span> de coefficient</p>
<div class="math notranslate nohighlight">
\[\Meh_{i,j} = \int_{\trih} \mphih_j\mphih_i \diff(\xi,\eta),\]</div>
<p>est donnée par</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Meh = \frac{1}{24}\left(
  \begin{array}{c c c}
    2 &amp; 1 &amp; 1\\
    1 &amp; 2 &amp; 1\\
    1 &amp; 1 &amp; 2
  \end{array}
\right).\end{split}\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. Prenons tout d’abord le cas <span class="math notranslate nohighlight">\(i=j=2\)</span>, soit <span class="math notranslate nohighlight">\(\mphih_i(\xi,\eta) = \mphih_j(\xi,\eta) = \xi\)</span>. Dans ce cas :</p>
<div class="math notranslate nohighlight">
\[\int_{\trih} \xi^2 \diff (\xi,\eta) = \int_0^1\int_0^{1-\xi} \xi^2 \diff\eta\diff\xi = \int_0^1(1-\xi)\xi^2\diff\xi =
\left[\frac{\xi^3}{3} - \frac{\xi^4}{4}\right]_0^1=\frac{1}{3}-\frac{1}{4} = \frac{1}{12}.\]</div>
<p>Les calculs sont similaires pour <span class="math notranslate nohighlight">\(i=1\)</span> et <span class="math notranslate nohighlight">\(i=3\)</span>. Prenons maintenant <span class="math notranslate nohighlight">\(i\neq j\)</span>, par exemple <span class="math notranslate nohighlight">\(i=3\)</span> et <span class="math notranslate nohighlight">\(j=2\)</span> :</p>
<div class="math notranslate nohighlight">
\[\int_{\trih} \xi\eta \diff (\xi,\eta) = \int_0^1\left(\int_0^{1-\xi} \eta \diff\eta\right)\xi\diff\xi =  \frac{1}{2}\int_0^1(1-\xi)^2\xi\diff\xi    =  \frac{1}{2}\left[ \frac{1}{2} - \frac{2}{3} +\frac{1}{4}\right] =\frac{1}{24}.\]</div>
<p>Les calculs sont similaires pour les autres combinaisons.</p>
</div>
</section>
<section id="triangle-quelconque">
<h3><span class="section-number">4.4.3.2. </span>Triangle quelconque<a class="headerlink" href="#triangle-quelconque" title="Lien permanent vers ce titre">#</a></h3>
<p><strong>Changement de coordonnées.</strong> Soit un triangle <span class="math notranslate nohighlight">\(\tri_p\)</span> du maillage et supposons que nous disposions d’une transformation bijective et linéaire <span class="math notranslate nohighlight">\(\trihToTri{p}\)</span> permetteant de transformer le triangle de référence <span class="math notranslate nohighlight">\(\trih\)</span> en <span class="math notranslate nohighlight">\(\tri_p\)</span> avec en plus <span class="math notranslate nohighlight">\(\trihToTri{p}(\verticeh_i) = \vertice_i^p\)</span> (conservation de l’ordre des sommets). Cette fonction <span class="math notranslate nohighlight">\(\trihToTri{p}\)</span> transforme les  <strong>coordonnées paramétriques</strong> <span class="math notranslate nohighlight">\((\xi,\eta)\)</span> en <strong>coordonnées physiques</strong> <span class="math notranslate nohighlight">\((x,y)\)</span> avec <span class="math notranslate nohighlight">\((x,y)=\trihToTri{p}(\xi,\eta)\in\tri_p\)</span>, et conserve « l’ordre des sommets ».</p>
<figure class="align-center" id="id4" style="width: 100%">
<span id="fig-transformation"></span><a class="reference internal image-reference" href="../../_images/transformation.svg"><img alt="Transformation entre le triangle de référence et un triangle quelconque" src="../../_images/transformation.svg" width="75%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.6 </span><span class="caption-text">Transformation entre le triangle de référence <span class="math notranslate nohighlight">\(\trih\)</span> et un triangle quelconque <span class="math notranslate nohighlight">\(\tri_p\)</span>.</span><a class="headerlink" href="#id4" title="Lien permanent vers cette image">#</a></p>
</figcaption>
</figure>
<p>Nous avons <span class="math notranslate nohighlight">\(\mphi_j^p(x,y) = \mphi_j^p(\trihToTri{p}(\xi,\eta))\)</span> avec <span class="math notranslate nohighlight">\(\mphi_j^p\circ\trihToTri{p}\in\Pb^1(\trih)\)</span> et <span class="math notranslate nohighlight">\(\mphi_j^p\circ\trihToTri{p}(\verticeh_i) = \delta_{ij}\)</span>, soit exactement les mêmes propriétés que les <span class="math notranslate nohighlight">\(\mphih_i\)</span>. Par unicité, nous avons <span class="math notranslate nohighlight">\(\mphi_j^p\circ\trihToTri{p} = \mphih_j\)</span>.</p>
<p>En notant <span class="math notranslate nohighlight">\(\JK{p}\)</span> la matrice Jacobienne de <span class="math notranslate nohighlight">\(\trihToTri{p}\)</span>, alors la quantité <span class="math notranslate nohighlight">\((\Me{p})_{i,j}\)</span> peut alors s’écrire, par changement de variables :</p>
<div class="math notranslate nohighlight">
\[(\Me{p})_{i,j} = \displaystyle\int_{\tri_p}\mphi_j^p(x,y)\mphi_i^p(x,y) \diff(x,y)
=\displaystyle \abs{\det(\JK{p})}\underbrace{\int_{\trih}\mphih_j(\xi,\eta)\mphih_i(\xi,\eta)\diff(\xi,\eta)}_{\text{Déjà calculé !}}\]</div>
<p>Ainsi, pour calculer la matrice élémentaire d’un triangle <span class="math notranslate nohighlight">\(\tri_p\)</span> quelconque, nous n’avons besoin que du déterminant de la Jacobienne : <span class="math notranslate nohighlight">\(\det(\JK{p})\)</span>.</p>
<p><strong>Expression et Jacobienne de la transformation.</strong> La transformation que nous cherchons, <span class="math notranslate nohighlight">\(\trihToTri{p}\)</span>, est linéaire et « conserve » les sommets et leur ordre. Pour obtenir son expression, nous construisons des fonctions <strong>d’interpolation géométrique</strong>, <span class="math notranslate nohighlight">\((\psih_i)_{1\leq i \leq 3}\)</span>, linéaires sur <span class="math notranslate nohighlight">\(\trih\)</span> et telles que :</p>
<div class="math notranslate nohighlight">
\[\forall i,j=1,2,3 \quad \psih_i(\verticeh_j) = \deltaij.\]</div>
<p>La transformation aura alors pour expression :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{r c c l}
    \trihToTri{p}\colon &amp; \trih &amp; \to &amp; \tri_p\\
  &amp; (\xi,\eta) &amp; \mapsto &amp; \trihToTri{p}(\xi,\eta) = (x,y) = \psih_{1}(\xi,\eta) \vertice_{1}^{p} + \psih_{2}(\xi,\eta) \vertice_{2}^{p} + \psih_{3}(\xi,\eta) \vertice_{3}^{p}.
\end{array}\end{split}\]</div>
<p>En d’autres termes, les fonctions d’interpolation géométrique <span class="math notranslate nohighlight">\(\psih_i\)</span> sont ici identiques aux fonctions de forme <span class="math notranslate nohighlight">\(\mphih_i\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
  \begin{array}{l}
  \psih_{1}(\xi,\eta) = 1 - \xi - \eta\\
  \psih_{2}(\xi,\eta) = \xi\\
  \psih_{3}(\xi,\eta) = \eta\\
  \end{array}
\right.\end{split}\]</div>
<p>La matrice Jacobienne de la transformation est alors donnée par</p>
<div class="math notranslate nohighlight">
\[\begin{split}\JK{p} =
\left(
  \begin{array}{c c}
    \displaystyle\frac{\partial x}{\partial \xi} &amp;\displaystyle \frac{\partial x}{\partial \eta} \\
    \displaystyle\frac{\partial y}{\partial \xi} &amp;\displaystyle \frac{\partial y}{\partial \eta}
  \end{array}
\right) =
\left(
  \begin{array}{c c}
    x_{2}^{p} - x_{1}^{p} &amp; x_{3}^{p} - x_{1}^{p}\\
    y_{2}^{p} - y_{1}^{p} &amp; y_{3}^{p} - y_{1}^{p}
  \end{array}
\right),\end{split}\]</div>
<p>et son déterminant vaut</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\abs{\det(\JK{p})} &amp;= \abs{(x_{2}^{p}-x_{1}^{p})(y_{3}^{p}-y_{1}^{p}) - (x_{3}^{p}-x_{1}^{p})(y_{2}^{p}-y_{1}^{p})}\\
&amp;= 2|\tri_p| \neq 0,
\end{aligned}\end{split}\]</div>
<p>ce qui implique que le déterminant est non nul puisque le triangle n’est pas dégénéré : la transformation <span class="math notranslate nohighlight">\(\trihToTri{p}\)</span> est bien inversible.</p>
<div class="proof remark admonition" id="remark-4">
<p class="admonition-title"><span class="caption-number">Remark 4.9 </span></p>
<section class="remark-content" id="proof-content">
<p>Quand <span class="math notranslate nohighlight">\(\psih_i = \mphih_i\)</span>, nous parlons d’éléments finis <strong>isoparamétriques</strong>. Il convient de retenir que ce choix n’est pas obligatoire et les fonctions <span class="math notranslate nohighlight">\(\psih_i\)</span> et <span class="math notranslate nohighlight">\(\mphih_i\)</span> sont <strong>indépendantes</strong>. En particulier, pour obtenir des éléments courbes, les fonctions <span class="math notranslate nohighlight">\(\psih_i\)</span> pourraient être quadratiques par exemple.</p>
</section>
</div><div id="app-jacobian" class="app-container">
  <iframe id="iframe-jacobian" class="app-content" src='../../../_static/app/jacobian/index.html'></iframe>
  <p><strong>Déplacez les sommets du triangle</strong> pour modifier la valeur du <strong>Jacobien</strong>. Quand il est négatif cela signifie que le triangle est <strong>"retourné"</strong> par rapport au triangle de référence</p>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.1/iframeResizer.min.js" integrity="sha512-ngVIPTfUxNHrVs52hA0CaOVwC3/do2W4jUEJIufgZQicmY27iAJAind8BPtK2LoyIGiAFcOkjO18r5dTUNLFAw==" crossorigin="anonymous"></script>
<script>
  iFrameResize({}, '#iframe-jacobian')
</script><p><strong>Expression finale de la matrice élémentaire.</strong></p>
<div class="proof lemma admonition" id="lemma-5">
<p class="admonition-title"><span class="caption-number">Lemma 4.8 </span></p>
<section class="lemma-content" id="proof-content">
<p>La matrice de masse élémentaire <span class="math notranslate nohighlight">\(\Me{p} = ((\Me{p})_{i,j})_{0\leq i,j\leq 2}\)</span> du triangle <span class="math notranslate nohighlight">\(\tri_p\)</span> a pour expression</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Me{p} =   \frac{\abs{\tri_p}}{12}
\left(
  \begin{array}{c c c}
    2 &amp; 1 &amp; 1\\
    1 &amp; 2 &amp; 1 \\
    1 &amp; 1 &amp; 2
  \end{array}
  \right).\end{split}\]</div>
</section>
</div><div id="app-matrix-computation" class="app-container">
  <iframe id="iframe-matrix-computation" class="app-content" src='../../../_static/app/matrix-computation/index.html'></iframe>
  <p><strong>Cliquez sur un triangle</strong> pour ajouter ses <strong>contributions élémentaires</strong> dans la <strong>matrice de masse</strong>. Recliquez dessus pour les soustraire.</p>
</div>
<script>
  iFrameResize({}, '#iframe-matrix-computation')
</script></section>
</section>
<section id="matrice-de-rigidite-elementaire">
<h2><span class="section-number">4.4.4. </span>Matrice de rigidité élémentaire<a class="headerlink" href="#matrice-de-rigidite-elementaire" title="Lien permanent vers ce titre">#</a></h2>
<p>Nous appliquons la même procédure pour la matrice de rigidité <span class="math notranslate nohighlight">\(D\)</span>, autrement dit, nous calculons les matrices de rigidité élémentaire <span class="math notranslate nohighlight">\(\De{p}\)</span> définies par</p>
<div class="math notranslate nohighlight">
\[(\De{p})_{i,j} = \int_{\tri_p}\nabla \mphi_j^p(x,y)\cdot \nabla\mphi_i^p(x,y)\diff(x,y).\]</div>
<section id="id1">
<h3><span class="section-number">4.4.4.1. </span>Triangle de référence<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">#</a></h3>
<div class="proof lemma admonition" id="lemma-6">
<p class="admonition-title"><span class="caption-number">Lemma 4.9 </span></p>
<section class="lemma-content" id="proof-content">
<p>Dans le triangle de référence <span class="math notranslate nohighlight">\(\trih\)</span>, la matrice de rigidité élémentaire <span class="math notranslate nohighlight">\(\widehat{D}= (\widehat{D}_{i,j})_{1\leq i,j\leq 3}\)</span> de coefficient</p>
<div class="math notranslate nohighlight">
\[\widehat{D}_{i,j} = \int_{\trih}\nabla \mphih_j(\xi,\eta)\cdot \nabla\mphih_i(\xi,\eta)\diff(\xi,\eta),\]</div>
<p>a pour expression</p>
<div class="math notranslate nohighlight">
\[\begin{split}\widehat{D} =  \frac{1}{2}
\left(
  \begin{array}{l l c}
    2 &amp; -1 &amp; -1 \\
    -1 &amp; 1 &amp; 0 \\
    -1 &amp; 0 &amp; 1
  \end{array}
\right)\end{split}\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. Les gradients des fonctions de forme <span class="math notranslate nohighlight">\(\mphih_j\)</span> sont donnés par :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla_{\xi,\eta}\mphih_0 =
\begin{pmatrix}
    -1\\
    -1
  \end{pmatrix}
,
\quad
\nabla_{\xi,\eta}\mphih_1 =
  \begin{pmatrix}
    1\\
    0
  \end{pmatrix},
\quad
\nabla_{\xi,\eta}\mphih_2 =
  \begin{pmatrix}
    0\\
    1
\end{pmatrix}.\end{split}\]</div>
<p>La matrice étant symétrique, nous pouvons limiter les calculs à la partie triangulaire supérieure :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\widehat{D}_{1,1} &amp;=
  \int_{\trih}\nabla\mphih_1\cdot\nabla\mphih_1 \diff (\xi,\eta) =
  \int_{\trih} (-1,-1)\begin{pmatrix}-1\\ -1\end{pmatrix}\diff (\xi,\eta) =
  2 \int_{\trih} \diff(\xi,\eta) &amp;&amp;= 1\\
\widehat{D}_{2,2} &amp;=
  \int_{\trih}\nabla\mphih_2\cdot\nabla\mphih_2 \diff (\xi,\eta) =
  \int_{\trih} (1,0)\begin{pmatrix}1\\ 0\end{pmatrix} \diff (\xi,\eta) =
    \int_{\trih} \diff(\xi,\eta) &amp;&amp;= \frac{1}{2} =\widehat{D}_{3,3}\\
\widehat{D}_{1,2} &amp;=
  \int_{\trih}\nabla\mphih_1\cdot\nabla\mphih_2 \diff (\xi,\eta) =
  \int_{\trih} (-1,-1)\begin{pmatrix}1\\ 0\end{pmatrix} \diff (\xi,\eta) =
    -\int_{\trih} \diff(\xi,\eta) &amp;&amp;= -\frac{1}{2}\\
\widehat{D}_{1,3} &amp;=
  \int_{\trih}\nabla\mphih_1\cdot\nabla\mphih_3 \diff (\xi,\eta) =
  \int_{\trih} (-1,-1)\begin{pmatrix}0\\ 1\end{pmatrix} \diff (\xi,\eta) =
    -\int_{\trih} \diff(\xi,\eta)&amp;&amp; = -\frac{1}{2}\\
\widehat{D}_{2,3} &amp;=
  \int_{\trih}\nabla\mphih_2\cdot\nabla\mphih_3 \diff (\xi,\eta) =
  \int_{\trih} (1,0)\begin{pmatrix}0\\ 1\end{pmatrix} \diff (\xi,\eta) &amp;&amp;=
  0.
\end{aligned}\end{split}\]</div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">4.4.4.2. </span>Triangle quelconque<a class="headerlink" href="#id2" title="Lien permanent vers ce titre">#</a></h3>
<p>Pour calculer les dérivées partielles selon <span class="math notranslate nohighlight">\(x\)</span> et <span class="math notranslate nohighlight">\(y\)</span> de <span class="math notranslate nohighlight">\(\mphih_j\)</span>, nous utilisons la dérivée de fonction composée :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
    \displaystyle \frac{\partial \mphi_j^p}{\partial x}\\[0.2cm]
    \displaystyle \frac{\partial \mphi_j^p}{\partial y}
  \end{pmatrix} =
\begin{pmatrix}
    \displaystyle \frac{\partial \xi}{\partial x} &amp; \displaystyle \frac{\partial \eta}{\partial x}\\[0.2cm]
    \displaystyle \frac{\partial \xi}{\partial y} &amp; \displaystyle \frac{\partial \eta}{\partial y}
\end{pmatrix}
\begin{pmatrix}
    \displaystyle \frac{\partial \mphih_j}{\partial \xi}\\[0.2cm]
    \displaystyle \frac{\partial \mphih_j}{\partial \eta}
\end{pmatrix}\end{split}\]</div>
<p>En notant <span class="math notranslate nohighlight">\(\BK{p}\)</span> la matrice de passage, nous avons</p>
<div class="math notranslate nohighlight">
\[\nabla_{x,y}\mphi_j^p(x,y) = \BK{p}\nabla_{\xi,\eta}\mphih_j(\xi,\eta).\]</div>
<p>L’opération « inverse » nous donne :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
    \displaystyle \frac{\partial \mphih_j}{\partial \xi}\\[0.2cm]
    \displaystyle \frac{\partial \mphih_j}{\partial \eta}
  \end{pmatrix}
  =
\begin{pmatrix}
  \displaystyle \frac{\partial x}{\partial \xi} &amp; \displaystyle \frac{\partial y}{\partial \xi}\\[0.2cm]
  \displaystyle \frac{\partial x}{\partial \eta} &amp; \displaystyle \frac{\partial y}{\partial \eta}
\end{pmatrix}
\begin{pmatrix}
  \displaystyle \frac{\partial \mphi_j^p}{\partial x}\\[0.2cm]
  \displaystyle \frac{\partial \mphi_j^p}{\partial y}
\end{pmatrix}
\iff
\nabla_{\xi,\eta}\mphih_j(\xi,\eta) = (\JK{p})^T\nabla_{x,y}\mphi_j^p(x,y).\end{split}\]</div>
<p>Nous en déduisons que <span class="math notranslate nohighlight">\(\BK{p} = (\JK{p}^T)^{-1}\)</span>, en particulier, dans le cas d’une transformation linéaire de triangle, nous obtenons :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\BK{p} =
\frac{1}{\det(\JK{p})}
  \left(
  \begin{array}{c c}
    y_{3}^{p}-y_{1}^{p} &amp; y_{1}^{p}-y_{2}^{p}\\
    x_{1}^{p}-x_{3}^{p} &amp; x_{2}^{p}-x_{1}^{p}
  \end{array}
\right).\end{split}\]</div>
<p>Au final, comme <span class="math notranslate nohighlight">\(X\cdot Y = X^TY\)</span>, nous obtenons</p>
<div class="math notranslate nohighlight" id="equation-eq-intrigidite">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-eq-intrigidite" title="Lien permanent vers cette équation">#</a></span>\[\int_{\tri_p} (\nabla\mphi_j^p)^T\nabla\mphi_i^p \diff(x,y)
  = \abs{\det(\JK{p})}\int_{\trih} (\nabla\mphih_j)^T  (\BK{p}^T \BK{p})\nabla\mphih_i \diff (\xi,\eta).\]</div>
<p>En éléments finis <span class="math notranslate nohighlight">\(\Pb^1\)</span>, les fonctions de forme sont linéaires et leur gradient est donc constant. Nous pouvons alors sortir les termes <span class="math notranslate nohighlight">\(\nabla\mphih_i\)</span> et <span class="math notranslate nohighlight">\(\nabla\mphih_j\)</span> de l’intégral pour obtenir le lemme suivant.</p>
<div class="proof lemma admonition" id="lemma-7">
<p class="admonition-title"><span class="caption-number">Lemma 4.10 </span></p>
<section class="lemma-content" id="proof-content">
<p>Les coefficients a matrice de rigidité élémentaire <span class="math notranslate nohighlight">\(\De{p} = ((\De{p})_{i,j})_{1\leq i,j\leq 3}\)</span> sont obtenus pas la relation suivante</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
(\De{p})_{i,j} &amp;= \int_{\tri_p}\nabla \mphi_j^p(x, y)\cdot\nabla\mphi_i^p(x,y)\diff(x,y),\\
  &amp;= \abs{\tri_p}(\nabla\mphih_j)^T  (\BK{p}^T \BK{p})\nabla\mphih_i.
\end{aligned}\end{split}\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. Pour les éléments finis <span class="math notranslate nohighlight">\(\Pb^1\)</span>, les gradients <span class="math notranslate nohighlight">\(\nabla\mphih_j\)</span> sont constants et peuvent être sortis de l’intégrale. De plus, comme <span class="math notranslate nohighlight">\(\abs{\det(\JK{p})} = 2\abs{\tri_p}\)</span> et <span class="math notranslate nohighlight">\(\abs{\trih}= \frac{1}{2}\)</span>, nous avons</p>
<div class="math notranslate nohighlight">
\[\int_{\tri_p} \nabla\mphi_j^p\cdot\nabla\mphi_i^p \diff\xx=\abs{\tri_p}(\nabla\mphih_j)^T  (\BK{p}^T \BK{p})\nabla\mphih_i.\]</div>
</div>
</section>
</section>
<section id="second-membre-ou-rhs-ou-membre-de-droite">
<span id="sec-quadrature"></span><h2><span class="section-number">4.4.5. </span>Second membre (ou RHS ou Membre de droite)<a class="headerlink" href="#second-membre-ou-rhs-ou-membre-de-droite" title="Lien permanent vers ce titre">#</a></h2>
<p>Étudions maintenant les termes du membre de droite comme</p>
<div class="math notranslate nohighlight">
\[\int_{\tri_p}f(\xx)\mphi_i^p(\xx)\diff \xx.\]</div>
<p>Sauf pour certaines fonctions <span class="math notranslate nohighlight">\(f\)</span> particulières, nous ne pourrons certainement pas calculer explicitement ce terme, nous devons approcher cette intégrale à l’aide d’une formule de quadrature en passant à l’éléments de référence :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\displaystyle \int_{\tri_p}f(\xx)\mphi_i^p(\xx)\diff \xx &amp;=
\displaystyle \abs{\det(\JK{p})}\int_{\trih}f(\xx(\xi,\eta))\mphih_i(\xi,\eta)\diff (\xi,\eta) \\
&amp; \displaystyle \simeq \abs{\det(\JK{p})}\sum_{m=0}^{M-1}\omega_m f(\xx(\xi_m,\eta_m))\mphih(\xi_m,\eta_m).
\end{aligned}\end{split}\]</div>
<p>Les points <span class="math notranslate nohighlight">\((\xi_m,\eta_m)\)</span> sont appelés <strong>points de quadrature</strong> (parfois <strong>points de Gauss</strong>, même si la règle de quadrature utilisée n’est pas de Gauss) et les quantités <span class="math notranslate nohighlight">\(\omega_m\in\Rb\)</span> les <strong>poids</strong> associés. Notons que le point <span class="math notranslate nohighlight">\(\xx(\xi_m,\eta_m)\)</span> s’obtient par l’expression vue précédemment :</p>
<div class="math notranslate nohighlight">
\[\xx(\xi_m,\eta_m) = \sum_{i=0}^2\vertice_i^p\psih_i(\xi_m,\eta_m).\]</div>
<p>Nous présentons ici deux règles de quadrature pour l’intégrale <span class="math notranslate nohighlight">\(\int_{\trih}\gh(\xx)\diff\xx\)</span> sur <span class="math notranslate nohighlight">\(\trih\)</span> d’une fonction <span class="math notranslate nohighlight">\(g\)</span> quelconque. La première règle est exacte pour des polynômes de degré 1, la deuxième pour des polynômes de degré 2 (règles de Hammer) :</p>
<table class="table">
<colgroup>
<col style="width: 23%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(\xi_m\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\eta_m\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\omega_m\)</span></p></th>
<th class="head"><p>Degré de précision</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1/3</p></td>
<td><p>1/3</p></td>
<td><p>1/6</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1/6</p></td>
<td><p>1/6</p></td>
<td><p>1/6</p></td>
<td rowspan="3"><p>2</p></td>
</tr>
<tr class="row-even"><td><p>4/6</p></td>
<td><p>1/6</p></td>
<td><p>1/6</p></td>
</tr>
<tr class="row-odd"><td><p>1/6</p></td>
<td><p>4/6</p></td>
<td><p>1/6</p></td>
</tr>
</tbody>
</table>
<div class="proof remark admonition" id="remark-8">
<p class="admonition-title"><span class="caption-number">Remark 4.10 </span></p>
<section class="remark-content" id="proof-content">
<p>Les formules de quadrature ont évidemment un impact sur la qualité de l’approximation, toutefois, elles jouent un rôle relativement mineur par rapport aux autres approximations (et l’on peut choisir plus de points d’intégration !).</p>
</section>
</div><script defer="defer" src="https://d3js.org/d3.v5.min.js"></script>
<script defer="defer" src="https://d3js.org/d3-scale-chromatic.v1.min.js</script>
<script defer="defer" src="../../../_static/js/jacobian/main.js"></script></section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="assemblage.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Assemblage des Matrices</p>
      </div>
    </a>
    <a class="right-next"
       href="matrice-creuse.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title"><span class="section-number">4.5. </span>Matrice Creuse</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenu
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-de-masse-et-de-rigidite">4.4.1. Matrices de Masse et de Rigidité</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contribution-elementaire">4.4.2. Contribution élémentaire</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrice-de-masse-elementaire">4.4.3. Matrice de masse élémentaire</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triangle-de-reference">4.4.3.1. Triangle de référence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triangle-quelconque">4.4.3.2. Triangle quelconque</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrice-de-rigidite-elementaire">4.4.4. Matrice de rigidité élémentaire</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.4.4.1. Triangle de référence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4.4.4.2. Triangle quelconque</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-membre-ou-rhs-ou-membre-de-droite">4.4.5. Second membre (ou RHS ou Membre de droite)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Par Armand Wayoff
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024, Bertrand Thierry.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>